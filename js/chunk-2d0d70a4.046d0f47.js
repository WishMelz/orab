(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d70a4"],{"74b3":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户管理")]),r("el-breadcrumb-item",[e._v("用户列表")])],1),r("el-card",[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),r("el-col",{staticClass:"addsb",attrs:{span:6}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUserDia=!0}}},[e._v("添加用户")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.usersList,border:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{prop:"username",label:"姓名"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),r("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),r("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),r("el-table-column",{attrs:{prop:"mg_state",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.userStatus(t.row.id,t.row.mg_state,t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.getAlertUser(t.row.id)}}}),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteUser(t.row.id)}}}),r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(r){return e.getQuanxian(t.row)}}})]}}])})],1),r("el-pagination",{attrs:{"page-sizes":[2,5,10,15],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),r("el-dialog",{attrs:{title:"添加用户",visible:e.addUserDia,width:"50%"},on:{"update:visible":function(t){e.addUserDia=t},closed:function(t){return e.diaClosed("addRef")}}},[r("el-form",{ref:"addRef",attrs:{model:e.addForm,rules:e.addRul}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.addForm.mobile,callback:function(t){e.$set(e.addForm,"mobile",t)},expression:"addForm.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addUserDia=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addUsers}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"修改用户",visible:e.alertUserDia,width:"50%"},on:{"update:visible":function(t){e.alertUserDia=t},closed:function(t){return e.diaClosed("alterRef")}}},[r("el-form",{ref:"alterRef",attrs:{model:e.alertUserFrom,rules:e.addRul}},[r("el-form-item",{attrs:{label:"username"}},[r("el-input",{attrs:{disabled:""},model:{value:e.alertUserFrom.username,callback:function(t){e.$set(e.alertUserFrom,"username",t)},expression:"alertUserFrom.username"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.alertUserFrom.mobile,callback:function(t){e.$set(e.alertUserFrom,"mobile",t)},expression:"alertUserFrom.mobile"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.alertUserFrom.email,callback:function(t){e.$set(e.alertUserFrom,"email",t)},expression:"alertUserFrom.email"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.alertUserDia=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.alertUser}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"重新分配权限",visible:e.quanxianDia,width:"30%"},on:{"update:visible":function(t){e.quanxianDia=t}}},[r("p",[e._v("当前的用户："+e._s(e.assUserInfo.username))]),r("p",[e._v("当前的角色："+e._s(e.assUserInfo.role_name))]),r("p",[e._v("分配新角色\n      "),r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.assionVal,callback:function(t){e.assionVal=t},expression:"assionVal"}},e._l(e.assList,function(e){return r("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.quanxianDia=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.alertQuanxian}},[e._v("确 定")])],1)])],1)],1)},s=[],n=(r("96cf"),r("3b8d")),i={data:function(){return{usersList:[],queryInfo:{query:"",pagenum:1,pagesize:2},msStatus:!0,total:0,addUserDia:!1,addForm:{id:"",username:"",password:"",email:"",mobile:""},addRul:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"}]},alertUserDia:!1,alertUserFrom:{email:"",mobile:""},quanxianDia:!1,assList:[],assionVal:"",assUserInfo:{}}},methods:{getUserList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("users",{params:this.queryInfo});case 2:if(t=e.sent,r=t.data,200==r.meta.status){e.next=6;break}return e.abrupt("return",this.$message.error("获取用户列表失败"));case 6:this.total=r.data.total,this.usersList=r.data.users;case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()},addUsers:function(){var e=this;this.$refs.addRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(r){var a,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.post("users",e.addForm);case 4:if(a=t.sent,s=a.data,201==s.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error(s.meta.msg));case 8:e.addUserDia=!1,e.$message.success("添加成功"),e.getUserList();case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},userStatus:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,r,a){var s,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.put("users/".concat(t,"/state/").concat(r));case 2:if(s=e.sent,n=s.data,200==n.meta.status){e.next=7;break}return a.mg_state=!a.mg_state,e.abrupt("return",this.$message.error("设置失败"));case 7:this.$message.success("修改成功");case 8:case"end":return e.stop()}},e,this)}));function t(t,r,a){return e.apply(this,arguments)}return t}(),getAlertUser:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.alertUserDia=!0,e.next=3,this.$http.get("users/"+t);case 3:if(r=e.sent,a=r.data,200==a.meta.status){e.next=7;break}return e.abrupt("return",this.$message.error("获取用户失败"));case 7:this.alertUserFrom=a.data;case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),alertUser:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.put("users/"+this.alertUserFrom.id,this.alertUserFrom);case 2:if(t=e.sent,r=t.data,200==r.meta.status){e.next=6;break}return e.abrupt("return",this.$message.error("修改失败"));case 6:this.alertUserDia=!1,this.$message.success("修改成功"),this.getUserList();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),deleteUser:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.delete("users/"+t);case 2:if(r=e.sent,a=r.data,200==a.meta.status){e.next=6;break}return e.abrupt("return",this.$message.error("删除用户失败"));case 6:this.$message.success("删除用户成功"),this.getUserList();case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getQuanxian:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.assUserInfo=t,this.quanxianDia=!0,e.next=4,this.$http.get("roles");case 4:if(r=e.sent,a=r.data,200==a.meta.status){e.next=8;break}return e.abrupt("return",this.$message.error("权限获取失败"));case 8:this.assList=a.data;case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),alertQuanxian:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.put("users/".concat(this.assUserInfo.id,"/role"),{rid:this.assionVal});case 2:if(t=e.sent,r=t.data,200==r.meta.status){e.next=6;break}return e.abrupt("return",(this.$message,error("权限修改失败")));case 6:this.quanxianDia=!1,this.$message.success("权限修改成功"),this.getUserList();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.getUserList()}},o=i,l=r("2877"),u=Object(l["a"])(o,a,s,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0d70a4.046d0f47.js.map